President Obama, speaking to an American television audience on Tuesday night from Bagram Air Base, declared that he had traveled here to herald a new era in the relationship between the United States and Afghanistan, "a future in which war ends, and a new chapter begins."

Mr. Obama's address, during an unannounced visit to sign a strategic partnership agreement with President Hamid Karzai that sets the terms for relations after the departure of American troops in 2014, was a chance for him to make an election-year case that he is winding down a costly and increasingly unpopular war.

"My fellow Americans," he said, speaking against a backdrop of armored military vehicles and an American flag, "we've traveled through more than a decade under the dark cloud of war. Yet here, in the pre-dawn darkness of Afghanistan, we can see the light of new day on the horizon."

His speech came as an already difficult relationship with Mr. Karzai has been strained by recent events, including the release of photos showing American soldiers posing with the remains of Taliban insurgents and an American staff sergeant who has been charged in the killing of 16 Afghan civilians. Mr. Obama sought to portray the withdrawal as an unalloyed achievement, though it remains far from certain that the Afghan government can hold its own against the Taliban with reduced American support, or that what were once considered critical American goals here can still be met.

Hours after Mr. Obama left Afghanistan, at least two explosions shook Kabul on Wednesday morning, near a compound used by United Nations workers and other foreigners, local reports said. According to an interior minister, at least six people, including five civilians and a security guard, were killed. The Taliban has claimed responsibility.

The president's dramatic six-hour visit, ending a year to the day after Osama bin Laden was killed in a raid in neighboring Pakistan, was laden with symbolism, historic and political. Speaking from the country where the 9/11 terrorist attacks were incubated, Mr. Obama suggested that America had come full circle.

"One year ago, from a base here in Afghanistan, our troops launched the operation that killed Osama bin Laden," the president said. "The goal I set -- to defeat Al Qaeda, and deny it a chance to rebuild -- is now within our reach."

Asserting that the United States had largely achieved its military goals, Mr. Obama said that Afghans were ready to take responsibility for their own security, a transition that will start in earnest next year when American and NATO troops step back from a combat role to training and counterterrorism operations.

But Mr. Obama also spoke of an "enduring partnership" with Afghanistan, invoking the agreement, which pledges American help for a decade in developing the Afghan economy and public institutions, though it makes no concrete financial commitments, which Congress would have to authorize each year.

The agreement, Mr. Karzai said during a midnight signing ceremony at his presidential palace, opened "a new chapter in the relationship between the United States and Afghanistan," one marked by "mutual respect."

Mr. Obama, who arrived after nightfall at Bagram Air Base north of Kabul under a veil of secrecy, flew by helicopter to the palace, passing low over the inky silhouette of the Hindu Kush Mountain range. Once there, he met briefly with Mr. Karzai before they emerged to sign the pact.

"With this agreement the Afghan people, and the world, should know that Afghanistan has a friend and a partner in the United States," Mr. Obama said as Mr. Karzai looked on, along with an audience of Afghan and American officials, including two Democratic senators, Jack Reed of Rhode Island and Carl Levin of Michigan.

As part of its effort to broker a political settlement between the Afghan government and insurgents, Mr. Obama said, "my administration has been in direct discussion with the Taliban." It was his most candid acknowledgment of the often-shadowy talks between American diplomats and the Taliban.

If Mr. Obama was emphasizing American constancy at the palace, his speech to his audience back home put greater emphasis on turning the page. The United States, he said, needed to turn its energies from war to rebuilding, a resilience that was on display on the site of the 2001 terrorist attacks in New York City, where "sunlight glistens off soaring new towers in downtown Manhattan."

The president also answered critics, notably his likely Republican opponent, Mitt Romney, who said the administration erred by setting a deadline for withdrawing troops, since the Taliban could simply wait out the Americans.

"Our goal is not to build a country in American's image, or to eradicate every vestige of the Taliban," Mr. Obama said. "These objectives would require many more years, many more dollars and many more American lives."

The surprise trip came even as his re-election campaign set off a debate about the propriety of using Bin Laden's killing to make a political argument in the battle with Mr. Romney. But Republicans largely held their rhetorical fire in the hours after Mr. Obama's arrival in Afghanistan was made public.

In a statement issued after Mr. Obama left to return to Washington, Mr. Romney said he was "pleased" by the president trip. "It would be a tragedy for Afghanistan and a strategic setback for America if the Taliban returned to power and once again created a sanctuary for terrorists," the statement said.

For the president, the visit showcased what his aides said was his determination to end the war responsibly, even as they conceded that the country American troops will leave behind will be a messy, violent place.

The president's view was reflected in the remarks of another senior official, who told reporters that the agreement will give the United States "the capacity to carry out the counterterrorism operations that are necessary for Al Qaeda not to resettle." It will help ensure "a regional equilibrium that serves our national security interest. And that's ultimately why we went in there in the first place."

Mr. Obama devoted much of his visit to the troops, visiting wounded soldiers at a hospital on Bagram Air Base, where he awarded 10 Purple Heart decorations, and speaking by radio to military personnel in other parts of the country who were involved in arranging his trip.

"The reason the Afghans have a new tomorrow is because of you," Mr. Obama said to 3,200 cheering troops assembled before dawn on Wednesday in a cavernous hangar, against a backdrop of an American flag and several armored vehicles.

The timing of the trip, administration officials said, was dictated by the desire of both presidents to sign the agreement before a NATO summit meeting in Chicago later this month. But it also came just four days before two big campaign rallies that serve as the symbolic kickoff of Mr. Obama's re-election bid, which will emphasize his success in ending the war in Iraq and winding down the conflict in Afghanistan.

With polls showing a large majority of Americans weary with the war, the president's aides have discussed whether to accelerate current plans, which call for withdrawing 23,000 troops by September. In Chicago, the United States and NATO allies will ratify a shift in the mission in 2013 from a combat role to one focused on counterterrorism and training of Afghan security forces.

For Mr. Obama, the visit was a chance to meet again with Mr. Karzai, with whom the United States has had a sometimes difficult relationship. On a stop here in March 2010, Mr. Obama delivered pointed criticism of Mr. Karzai for the rampant graft in the Afghan government. Ten months later, he made a return trip, only to be grounded at Bagram by swirling winds, forcing him to speak to Mr. Karzai by phone.

Though Mr. Karzai appeared elated at the ceremony, he has frequently expressed frustration with the American presence, bitterly criticizing the United States on issues like night raids conducted by Special Operations troops and civilian casualties.

The United States turned over authority for those raids to Afghan forces last month, opening the door to the broader agreement. The pact signed early Wednesday, negotiated by the American ambassador to Afghanistan, Ryan C. Crocker, and Afghanistan's national security adviser, Rangin Dadfar Spanta, addresses a broad range of issues, from security to social and economic development.

But it does not contain specific dollar commitments by the United States, which has led some critics to dismiss it as less a blueprint than a symbolic gesture.

To keep a wrap on Mr. Obama's travels, the White House resorted to some legerdemain, putting out a schedule for Tuesday that said the president would take part in an Oval Office meeting with advisers in the morning, then meet there with Mr. Biden and Defense Secretary Leon E. Panetta on Tuesday afternoon.

Instead, late on Monday, Mr. Obama slipped out of the White House and traveled to Joint Base Andrews. At midnight, Air Force One, its lights switched off and window shades drawn, rolled out from behind a hangar. A small group of reporters, including one from The New York Times, were allowed to accompany the president, after they agreed not to report on his whereabouts until his helicopter landed in Kabul.