President Barack Obama made a symbolic trip to Afghanistan on Tuesday, arriving on the first anniversary of the killing of al Qaeda leader Osama bin Laden to sign an agreement with President Hamid Karzai that marks a transition in the war while committing the U.S. to another decade of economic and military aid.

Mr. Obama said the Strategic Partnership Agreement he signed in Kabul would allow the U.S. to disentangle from Afghanistan, while not specifying funding or troop levels.

The trip came amid complaints by critics that Mr. Obama has politicized bin Laden's death. The president drew cheers in a speech to troops for his mention of the U.S. raid that killed the mastermind behind the attacks that sparked the decadelong war.

"We did not choose this war. This war came to us on 9/11," Mr. Obama told U.S. troops who had gathered at Bagram Air Base.

He also delivered a rare prime-time televised address in which he assured Americans that the U.S. role in Afghanistan is shrinking while also promising long-term aid to the Afghans. "I recognize that many Americans are tired of war," Mr. Obama said. "But we must finish the job we started in Afghanistan and end this war responsibly."

Hours after Mr. Obama delivered his predawn speech and left Afghanistan, insurgents attacked a fortified compound that houses thousands of Westerners, including U.S. Department of Defense contractors and European Union police trainers, on the outskirts of Kabul.

Insurgents used at least two car bombs to attack the front gate of Green Village before other attackers stormed the gate and got inside the parking lot of the compound, according to one resident of the compound.

Well-armed contractors defended the facility as insurgents used rocket-propelled grenades and machine guns to try to attack, the resident said. Several Westerners were injured in the assault, but security managed to contain the attackers, he said. An hour after the attack, only one insurgent remained contained on the compound. The Kabul police chief at the scene said that six people were killed, including one Afghan student and one guard at Green Village.

Taliban spokesman Zabihullah Mujahid told The Wall Street Journal that the attack was a direct response to the president's visit. "This delivers a message to President Obama that he is not welcome in Afghanistan," said Mr. Mujahid. "When he is in Afghanistan, we want him to hear the sound of explosions. Afghanistan does not want his imposed strategy."

Hours earlier, Mr. Obama said his administration has been in direct talks with the Taliban, the first public acknowledgment of the negotiations by the president.

"We have made it clear that they can be a part of this future if they break with al Qaeda, renounce violence and abide by Afghan laws," Mr. Obama said.

But senior administration officials said Tuesday that a key part of those talks, a deal to open a Taliban office in Qatar, had stalled. The pact Messrs. Obama and Karzai signed outlines a 10-year relationship between Afghanistan and the U.S. after most American forces withdraw from the country in 2014.

The White House said the deal "provides for the possibility of U.S. forces in Afghanistan after 2014, for the purposes of training Afghan forces and targeting the remnants of al Qaeda." Congress will help determine funding and troop levels, setting the stage for a potential political battle.

The agreement cements Afghanistan as a "major non-NATO ally" of the U.S., a designation meant to signify the country's role as an important American ally.

The deal also seeks to address regional concerns about American military influence in the region by clearly stating that the U.S. doesn't want permanent military bases in Afghanistan. Instead, American forces will rely on Afghan bases to stage missions to fight any remaining al Qaeda forces in the region and to train Afghan troops.

In return, U.S. negotiators secured assurances from Afghan officials that the nation would do more to combat corruption, which remains one of the most serious challenges to long-term stability in Afghanistan.

Mr. Obama called the signing of the agreement "a historic moment for our two nations."

His trip, which wasn't publicly announced beforehand for security reasons, follows a series of efforts by the White House and the Obama campaign to commemorate the bin Laden killing, which the president's advisers see as his crowning national-security achievement.

Those efforts have brought charges from Republicans, including presumptive Republican nominee Mitt Romney, that the president and his aides are inappropriately using the anniversary for political gain.

But Mr. Obama's drew praise from some GOP leaders for his Afghanistan strategy. Sen. Lindsay Graham (R., S.C.), a frequent critic, said the deal "will help secure our nation and allies from future attacks using Afghanistan as a staging area." Sen. John McCain (R., Ariz.), who has complained about Mr. Obama's references to bin Laden, praised the president's trip to Afghanistan and said he hoped the new agreement "will send a signal to friends and enemies in the region that the United States is committed to a secure and free Afghanistan."

Senior administration officials, while acknowledging the symbolism of scheduling Mr. Obama's visit around the anniversary of bin Laden's death, told reporters traveling with the president that the trip was driven by negotiations over the strategic-partnership agreement.