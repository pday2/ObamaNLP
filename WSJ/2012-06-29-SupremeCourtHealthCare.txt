Chief Justice John Roberts joined the Supreme Court's four liberals Thursday to uphold the linchpin of President Barack Obama's plan to expand health coverage to nearly all Americans, a surprise conclusion to a constitutional showdown.

The ruling clears the way for the biggest revamp of the U.S. health-care system since the 1960s -- and sets the stage for a renewed political fight over its merits.

By a 5-4 vote, the court held the law's mandate requiring Americans to carry health insurance or pay a penalty valid under Congress's constitutional authority to levy taxes. The financial penalty for failing to carry insurance possesses "the essential feature of any tax," producing revenue for the government, Chief Justice Roberts wrote.

But the court gave a consolation prize to the 26 largely Republican-led states that challenged the law -- and opened a new door to their resistance. It ruled that the U.S. government couldn't expel states from Medicaid if they refused to go along with the expanded eligibility for the federal-state health program that is part of the health law.

The decision, tensely awaited for months, proved a vast relief to Democrats and Mr. Obama.

Speaking at the White House, the president retold the story of a woman with cancer who had to go without insurance and said, "Because of this law, there are other Americans . . . who will not have to hang their fortunes on chance. These are the Americans for whom we passed this law."

But the decision also handed Republicans a sharper message for the fall campaign: They said they would tell Americans who dislike "Obamacare" that electing GOP candidates is the only way to repeal it. What's more, by calling the insurance penalty the legal equivalent of a tax, the court allows Republicans to accuse the president of raising taxes for some.

"This is now a time for the American people to make a choice," said presumptive Republican presidential nominee Mitt Romney. "You can choose whether you want to have a larger and larger government."

The ruling means that the law's reordering of the $2.7 trillion health industry will move forward mostly as planned, with implications affecting every hospital, doctor, health insurer and drug maker in the nation. About 30 million more Americans are expected to gain coverage, although the Medicaid change could lower that.

Altogether, the ruling is both a political and a constitutional landmark. It bestows a measure of validation on President Obama's legislative achievement after two years of relentless attacks and casts a new light on Chief Justice Roberts -- a George W. Bush appointee whom some Democrats had pegged as a Republican partisan -- reaching across the ideological divide even while reinforcing some long-standing conservative principles.

Not only did the chief justice revive states' rights in the Medicaid ruling, he also rejected the principal legal basis the Obama administration invoked to justify the health-care overhaul, Congress's constitutional authority to regulate interstate commerce. Since the New Deal of the 1930s, the Supreme Court had only twice found Congress exceeded its commerce authority, and never for a program designed to expand the social safety net.

Congress has invoked its commerce power to pass a vast array of laws, from the Endangered Species Act to the Civil Rights Act of 1964, often over conservative complaints that such regulation exceeded the intent of the Constitution's framers. On Thursday, however, Chief Justice Roberts drew a firm limit on the commerce power, writing that if accepted as the basis of the individual insurance mandate, federal authority would be virtually unlimited.

"The Commerce Clause is not a general license to regulate an individual from cradle to grave, simply because he will predictably engage in particular transactions," the chief justice wrote. Four dissenting conservatives, Justices Antonin Scalia, Anthony Kennedy, Clarence Thomas and Samuel Alito, agreed.

But Justice Ruth Bader Ginsburg, joined by Justices Stephen Breyer, Sonia Sotomayor and Elena Kagan, said the Commerce Clause was enough to justify the law, which she said "addresses the very sort of interstate problem that made the commerce power essential in our federal system."

Chief Justice Roberts added that the penalty for failing to carry insurance met the criteria for a tax. Because of the court's duty to defer to the elected branches when possible, the mandate must be upheld, he wrote.

Neither the label of "penalty" nor the fact it was intended to influence behavior mattered, he wrote. The penalty functioned like a tax -- and other taxes, such as those on cigarettes, are enacted principally to create incentives rather than raise revenue, he said.

Although the Obama administration always asserted the penalty was valid under the federal taxing power, until Thursday no court had fully accepted that.

It was a day of surprises at the court, including the role of Chief Justice Roberts as the deciding vote instead of the usual swing voter, Justice Kennedy. Reading a joint dissent from the bench, Justice Kennedy said the majority engaged in "vast judicial overreaching" and decided "to save a statute Congress did not write."

Before the decision was read, the packed courtroom was silent. The chief began by rejecting Congress's power to legislate the mandate under the Commerce Clause. Many in the audience thought he was en route to striking down the law.

Then, about halfway through his 20-minute recitation, Chief Justice Roberts turned to Congress's taxing power. Some in the audience expressed surprise as listeners realized the law would survive.