Seven weeks after their frenetic retreat from Ramadi, Iraqi security forces are preparing to mount a counteroffensive in the coming weeks to try to reclaim the pivotal western Iraqi city from the Islamic State, American and Iraqi officials say.

Since the Islamic State seized Ramadi in May, about 2,000 militant fighters have been building up defenses -- including rigging empty buildings with explosives.

Struggling to regain the momentum in its campaign to "degrade" and ultimately defeat the Islamic State, the militant group also known as ISIS or ISIL, the Obama administration wants the Iraqis to retake the city before the militants dig in even more.

At the Pentagon on Monday, President Obama said the fall of Ramadi was a setback that had "galvanized" the Iraqi government and accelerated an American effort that had been "moving too slowly" to better train and equip Iraqi forces, including Sunni fighters.

"This will not be quick -- this is a long-term campaign," Mr. Obama said of the fight against the militant group after meeting for just under two hours with top military commanders to get an overview of the offensive. "ISIL is opportunistic, and it is nimble. In many places in Syria and Iraq, including urban areas, it's dug in among innocent civilian populations. It will take time to root them out, and doing so must be the job of local forces on the ground, with training and air support from our coalition."

The president offered no timetable for an Iraqi counterattack to reclaim Ramadi and did not announce any new steps to assist Iraqi troops in retaking the city, such as using American troops to call in airstrikes. But he insisted that the plans he announced last month were already bearing fruit. "More Sunni volunteers are coming forward," Mr. Obama said. "Some are already being trained, and they can be a new force against ISIL."

The assault force would be led by Iraq's counterterrorism service and would include the Iraqi federal police and army soldiers. The effort is expected to number about 6,000 troops, according to an Iraqi war plan that has been significantly shaped by American advisers sent to Al Taqqadum, an Iraqi base east of Ramadi.

An Iraqi follow-on force of up to 5,000 tribal fighters along with Iraqi provincial police officers would be assigned to hold the city and nearby areas in Anbar Province if they were retaken from the Islamic State.

Iraqi Shiite militia, which the government calls the Popular Mobilization Force, will not join in the assault in Ramadi -- a decision intended to avoid inflaming sectarian tensions in the Sunni city. Instead, the plan calls for the militia to set blocking positions south and west of the city, hoping to prevent Islamic State fighters from escaping.

American-led air power and aerial surveillance, including armed drones, would support the Iraqi push to seize the city.

The roles and basic composition of the Iraqi forces in the offensive were described by American officials, who insisted the Iraqi attack plan is being carefully prepared. These officials did not discuss the specific tactics or provide the precise timing for the offensive.

This attention to planning and sensitivity to overpromising success follow statements in May by Ashton B. Carter, the defense secretary, that Iraqi forces had demonstrated "no will to fight" against the Islamic State forces that moved on Ramadi, as well as criticism by congressional Republicans that the Obama administration had not done enough to help the Iraqis succeed.

The decision to focus on Ramadi represents an important shift in strategy for the United States' military, whose Central Command initially urged the Iraqis to focus this spring or summer on reclaiming Mosul, the capital of Iraq's northern Nineveh Province that was seized by the Islamic State more than a year ago.

But the Iraqis complained that they were not prepared to move that quickly, and State Department officials argued that Anbar Province was of strategic importance because it borders Saudi Arabia and Jordan and is home to Sunni tribes whose support is vital for any campaign to challenge the Islamic State.

The Islamic State's success in May in taking Ramadi, which is the capital of Anbar Province and which lies 70 miles west of Baghdad, sealed the debate over strategy by shaking the Iraqi government and puncturing the Central Command's claim that the Islamic State was on the defensive.

The United States' attempt to regain the initiative comes as the Pentagon is preparing to turn over command of the American-led military campaign in the region to two highly regarded combat veterans of the Iraq war.

Lt. Gen. Sean MacFarland, commander of the Army's III Corps at Fort Hood, Tex., is expected to assume command over the effort in Iraq and Syria and will be based in Kuwait early this fall. He replaces Lt. Gen. James L. Terry.

As brigade commander, General MacFarland played an important role in the campaign to retake Ramadi and other contested parts of Anbar Province in 2007, and he worked closely with the Sunni tribes.

In another change, Maj. Gen. Richard D. Clarke, commander of the 82nd Airborne Division, took charge in Baghdad last week of ground operations in Iraq, replacing Maj. Gen. Paul E. Funk II as part of a regular rotation.

General Clarke, a West Point graduate, has served four combat tours in Iraq. One of his recent assignments was operations director for the military's secretive Joint Special Operations Command, which oversees the Army's Delta Force and the Navy's SEAL Team 6.

The challenges they will face will go far beyond the situation in and around Ramadi.

Anxious about the threat to Baghdad from suicide attacks and car bombs, Prime Minister Haider al-Abadi of Iraq has kept a sizable force focused on the defense of the capital, including the 57th Brigade, which defends the Green Zone.

"One of the steps he has taken is to surround Baghdad with much of the remaining Iraqi security forces," Mr. Carter told Congress last month.

Eager to roll back the Islamic State's gains, the United States has held discussions with Mr. Abadi about shifting some of the Baghdad-based troops to be a part of the counterattack force in Anbar and, eventually, in northern cities like Mosul.

But the Iraqi government has been uneasy about diverting a sizable number of the Baghdad-based units elsewhere or giving the Shiite militias even more of a role in the eastern part of the capital, American officials say.

Additionally, planning offensive operations has been hampered by the problem of "ghost soldiers" -- troops formally on the military personnel rolls but who are not actually on the job.

Iraqi officials say about 22,000 troops in the Defense and Interior Ministries have deserted their units. The problem is said to have been particularly acute in the Iraqi Seventh Division, which is stationed at the Al Asad base in Anbar Province. The Iraqis want to cancel the contracts of the missing troops so that the funds allocated to pay them can be used to recruit soldiers, American officials say.

To date, the United States has trained about 8,300 Iraqi soldiers at five sites around the country, and some 2,000 are still in training programs. But the training capacity the United States military has established is 6,700 soldiers at any one time.

So there is excess capacity: More than 4,000 additional Iraqi soldiers could be in training right now if the Iraqis supplied the recruits or thought the situation was secure enough to divert some troops from protecting the capital, American officials said.

But the Islamic State's gains in Ramadi also led to a course correction on the American side. In April, Gen. Martin E. Dempsey, the chairman of the Joint Chiefs of Staff, suggested that Ramadi was of secondary importance.

"The city itself is not symbolic in any way," said General Dempsey, who added that it was not "central to the future of Iraq."

Those remarks reflected the Central Command's focus on Mosul, which an official from the command reaffirmed publicly as late as February. After Ramadi fell, the American priority shifted to Anbar, and Mr. Obama ordered an additional 450 American forces to Al Taqqadum.

The American role at the base is to advise the tribes, guide the Iraqi military plan and ensure that the efforts of Sunni tribes are coordinated with Iraqi security forces, specifically the Iraqi Eighth Division and the military's Anbar Operations Center.

The American efforts are broadly consistent with Mr. Abadi's five-part plan, which was announced in late May and calls, in part, for mobilizing the tribes and recruiting more soldiers.

About 500 tribal fighters showed up for initial training at Al Taqqadum a week and half ago. Some 300 provincial police officers have also been training as a potential holding force. Ultimately, thousands of provincial police officers are to be retrained in an effort in which the Italians have the lead.

American officials say the focus at Al Taqqadum has been on what failed in the Iraqis' defense of Ramadi: sustainment, leadership and using their numerical advantage against ISIS.

These officials said it makes a big difference to have the American advisers on site at Al Taqqadum, working side by side with the Iraqis.

"Can this approach work?" Mr. Carter said to reporters in Washington last Wednesday. "The important thing there is that the only way to have a lasting defeat of ISIL is to have someone who can govern and secure territory once ISIL is defeated. That has to be a local force on the ground. That's why the strategy calls for the United States to help train and equip, and then help enable local ground forces."
